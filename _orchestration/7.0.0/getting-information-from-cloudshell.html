<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
        <meta name="viewport" content="width=device-width">

        <title>CloudShell Developer Guide : Getting Information from CloudShell</title>
        <meta name="description" content="">
        <link rel="shortcut icon" type="image/png" href="/devguide_7/favicon.png?">
        <link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap.min.css" rel="stylesheet">
        <link rel="stylesheet" href="/devguide_7/css/main.css">
        <link rel="stylesheet" href="/devguide_7/css/prism.css">
        <link rel="stylesheet" href="/devguide_7/css/samples.css">
        <link rel="stylesheet" href="/devguide_7/css/normalize.css">
        <link rel="stylesheet" href="/devguide_7/css/test-hot-block.webflow.css">


        <link href="https://fonts.googleapis.com/css?family=Roboto" rel="stylesheet">
        <link href="https://fonts.googleapis.com/css?family=Lato" rel="stylesheet">
        <script src="/devguide_7/js/jquery-3.1.0.min.js"></script>
        <script src="/devguide_7/js/modernizr.js"></script>
        <script src="/devguide_7/js/webflow.js"></script>


        
        <script>
 (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
 (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
 m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
 })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

 ga('create', 'UA-81468206-1', 'auto');
 ga('send', 'pageview');

</script>

        <!-- Begin Jekyll SEO tag v2.1.0 -->
<title>Getting Information from CloudShell - CloudShell Developer Guide</title>
<meta property="og:title" content="Getting Information from CloudShell" />
<meta name="description" content="Information about the sandbox your script is running on and its components is automatically available in your script as an environment variable. The standard way to get that information in Python is to use the ‘os’ package." />
<meta property="og:description" content="Information about the sandbox your script is running on and its components is automatically available in your script as an environment variable. The standard way to get that information in Python is to use the ‘os’ package." />
<link rel="canonical" href="https://qualisystems.github.io/devguide_7/orchestration/getting-information-from-cloudshell.html" />
<meta property="og:url" content="https://qualisystems.github.io/devguide_7/orchestration/getting-information-from-cloudshell.html" />
<meta property="og:site_name" content="CloudShell Developer Guide" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2017-03-07T23:34:49+02:00" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:site" content="@qualisystems" />
<script type="application/ld+json">
{"@context": "http://schema.org",
"@type": "BlogPosting",
"headline": "Getting Information from CloudShell",
"datePublished": "2017-03-07T23:34:49+02:00",
"description": "Information about the sandbox your script is running on and its components is automatically available in your script as an environment variable. The standard way to get that information in Python is to use the ‘os’ package.",
"publisher": {"@type": "Organization",
"logo": {"@type": "ImageObject",
"url": "https://qualisystems.github.io/devguide_7/assets/logo.png"}},
"url": "https://qualisystems.github.io/devguide_7/orchestration/getting-information-from-cloudshell.html"}</script>
<!-- End Jekyll SEO tag -->

        
    </head>
    <body>
        <div id="header">
            <div class="container">
                <div class="row">
    <div class="col-md-3 col-sm-4">
        <a class="brand" href="/devguide_7/">
            <img alt="CloudShell Logo" src="/devguide_7/assets/logo.png" />
            CloudShell <small>Developer Guide</small>
        </a>
    </div>
    <div class="col-md-9 col-sm-8">
        <form class="search" action="/devguide_7/search.html">
            <input class="input" id="search-query" type="text" name="q" placeholder="Search" />
            <input class="button" type="submit" value="Search"></input>
        </form>
    </div>
</div>

            </div>
        </div>
        <div class="container">
            <div class="row">
                
                
                    <div id="navigation" class="col-md-3 col-sm-4">
                        <ul class="nav nav-list">
     
     
        <li class="nav-header"></li>
        
        
        
     
        <li class="nav-header">Introduction</li>
        
                <li data-page-id="index.md"><a href="/devguide_7/">The CloudShell DevGuide</a></li>
        
        
        
                    <li data-page-id="_introduction/setting-up-the-development-ide.md" data-order="1"><a href="/devguide_7/introduction/setting-up-the-development-ide.html">Setting up the Development Environment</a></li>
        
     
        <li class="nav-header">Extending cloudshell with shells</li>
        
        
        
                    <li data-page-id="_shells/getting-started.md" data-order="1"><a href="/devguide_7/shells/getting-started.html">Getting Started</a></li>
        
                    <li data-page-id="_shells/shell-driver-overview.md" data-order="2"><a href="/devguide_7/shells/shell-driver-overview.html">Shell Drivers Overview</a></li>
        
                    <li data-page-id="_shells/the-shell-project.md" data-order="3"><a href="/devguide_7/shells/the-shell-project.html">The Shell Project Guide</a></li>
        
                    <li data-page-id="_shells/modeling-the-shell.md" data-order="4"><a href="/devguide_7/shells/modeling-the-shell.html">Modeling the Shell</a></li>
        
                    <li data-page-id="_shells/getting-information-from-cloudshell.md" data-order="5"><a href="/devguide_7/shells/getting-information-from-cloudshell.html">Getting Information from CloudShell</a></li>
        
                    <li data-page-id="_shells/driver-deep-dive.md" data-order="6"><a href="/devguide_7/shells/driver-deep-dive.html">Driver Deep Dive</a></li>
        
                    <li data-page-id="_shells/customizing-driver-commands.md" data-order="6"><a href="/devguide_7/shells/customizing-driver-commands.html">Commands Visibility and Usability</a></li>
        
                    <li data-page-id="_shells/implementing-discovery-for-inventory-shells.md" data-order="7"><a href="/devguide_7/shells/implementing-discovery-for-inventory-shells.html">Implementing Discovery for Inventory Shells</a></li>
        
                    <li data-page-id="_shells/discovering-inventory-snmp.md" data-order="8"><a href="/devguide_7/shells/discovering-inventory-snmp.html">Discovering Inventory using SNMP</a></li>
        
                    <li data-page-id="_shells/debugging-shell-commands.md" data-order="9"><a href="/devguide_7/shells/debugging-shell-commands.html">Debugging Shell Driver Commands</a></li>
        
                    <li data-page-id="_shells/deploying-to-production.md" data-order="11"><a href="/devguide_7/shells/deploying-to-production.html">Deploying to Production</a></li>
        
                    <li data-page-id="_shells/common-driver-recipes.md" data-order="12"><a href="/devguide_7/shells/common-driver-recipes.html">Common Driver Recipes</a></li>
        
                    <li data-page-id="_shells/tips-and-tricks.md" data-order="13"><a href="/devguide_7/shells/tips-and-tricks.html">Tips and Tricks</a></li>
        
     
        <li class="nav-header">Orchestration scripts</li>
        
        
        
                    <li data-page-id="_orchestration/getting-started.md" data-order="1"><a href="/devguide_7/orchestration/getting-started.html">Getting Started</a></li>
        
                    <li data-page-id="_orchestration/getting-information-from-cloudshell.md" data-order="2"><a href="/devguide_7/orchestration/getting-information-from-cloudshell.html">Getting Information from CloudShell</a></li>
        
                    <li data-page-id="_orchestration/script-commands-customization.md" data-order="6"><a href="/devguide_7/orchestration/script-commands-customization.html">Script commands Visibility and Usability</a></li>
        
                    <li data-page-id="_orchestration/scripts-deep-dive.md" data-order="6"><a href="/devguide_7/orchestration/scripts-deep-dive.html">Scripts Deep Dive</a></li>
        
                    <li data-page-id="_orchestration/common-orchestration-recipes.md" data-order="9"><a href="/devguide_7/orchestration/common-orchestration-recipes.html">Common Orchestration Script Recipes</a></li>
        
                    <li data-page-id="_orchestration/the-oob-orchestration.md" data-order="9"><a href="/devguide_7/orchestration/the-oob-orchestration.html">CloudShell's OOB Orchestration</a></li>
        
     
        <li class="nav-header">Integrating cloudshell into the devops cycle</li>
        
        
        
                    <li data-page-id="_devops/devops-integration.md" data-order="1"><a href="/devguide_7/devops/devops-integration.html">Automating CloudShell Sandboxes for DevOps</a></li>
        
     
        <li class="nav-header">Reference</li>
        
        
        
                    <li data-page-id="_reference/python-coding-standards.md" data-order="7"><a href="/devguide_7/reference/python-coding-standards.html">Python Coding Standards</a></li>
        
     
</ul>

                    </div>

                    <div id="content" class="col-md-9 col-sm-8">
                        

<div class="page-header" data-page-id="_orchestration/getting-information-from-cloudshell.md">
    <h2>Getting Information from CloudShell
        
        
          <span style="float: right;font-size: 20px"><small><a href="https://github.com/QualiSystems/devguide_source/tree/master/_orchestration/getting-information-from-cloudshell.md">Suggest edits</a></small></span>
        
    </h2>
</div>

<p>Information about the sandbox your script is running on and its components is automatically available in your script
as an environment variable. The standard way to get that information in Python is to use the ‘os’ package.</p>

<figure class="highlight"><pre><code class="language-python" data-lang="python">import os
os.environ[&#39;RESERVATIONCONTEXT&#39;]
# {&quot;id&quot;:&quot;5487c6ce-d0b3-43e9-8ee7-e27af8406905&quot;,
#  &quot;ownerUser&quot;:&quot;bob&quot;,
#  &quot;ownerPass&quot;:&quot;nIqm+BG6ZGJjby5hUittVFFJASc=&quot;,
#  &quot;domain&quot;:&quot;Global&quot;,
#  &quot;environmentName&quot;:&quot;My environment&quot;,
#  &quot;description&quot;:&quot;New demo environment&quot;,
#  &quot;parameters&quot;:
#    { &quot;globalInputs&quot;: [],
#      &quot;resourceRequirements&quot;:[],
#      &quot;resourceAdditionalInfo&quot;:[]}}</code></pre></figure>

<p>However, we’ve added helpers to make it easier to get that information without having to parse the environment
variables yourself. Just import our helper classes to take advantage of that functionality.
You can use the following code to get an object which contains all of the sandbox information:</p>

<figure class="highlight"><pre><code class="language-python" data-lang="python">import cloudshell.helpers.scripts.cloudshell_scripts_helpers as helpers
helpers.get_reservation_context_details()</code></pre></figure>

<p>This will return a Python object you can use to query the same reservation information directly:</p>

<p><img src="/devguide_7/assets/reservation_context.png" alt="Sandbox information" class="img-responsive" /></p>

<h3 id="getting-the-sandbox-information-using-the-api">Getting the sandbox information using the API</h3>

<p>A common use case for a script is to get a list of the different Apps and resources in the sandbox, to be able
to call additional commands or API functions on them. To get that information we can use the CloudShellAPI.</p>

<p>To start a CloudShell API session, we need connectivity details to the Quali server. These details are also available
as an environment variable in your script called ‘qualiConnectivityContext’. As with the reservation information,
you can use the <em>script_helpers</em> module to quickly get the connectivity information in a more convenient object form
and initialize a CloudShellAPISession object by calling <em>helpers.get_reservation_context_details()</em>.</p>

<p>However, since initializing a CloudShell API session object is a very common operation, you can use the helpers to directly
create an object. The helper module will take care of passing all of the required connectivity information for you.
The <em>cloudshell_script_helpers</em> module provides a shortcut which makes accessing the CloudShell API from your script
much easier. Simply use the following code:</p>

<figure class="highlight"><pre><code class="language-python" data-lang="python">import cloudshell.helpers.scripts.cloudshell_scripts_helpers as helpers
helpers.get_api_session()</code></pre></figure>

<p>The <em>get_api_session()</em> function will return a CloudShell API session object. You can use the IDE’s autocomplete capabilities
to explore the available functions:</p>

<p><img src="/devguide_7/assets/api_autocomplete.png" alt="API Autocomplete" class="img-responsive" /></p>

<p>In this case we want to get information about the resources and Apps in the sandbox, so we can use the <em>GetReservationDetails</em>
function. The following code will iterate over the resources and Apps in the sandbox and print out their names:</p>

<figure class="highlight"><pre><code class="language-python" data-lang="python">reservation_id = helpers.get_reservation_context_details().id
reservation_details = helpers.get_api_session().GetReservationDetails(reservation_id).ReservationDescription

for resource in reservation_details.Resources:
    print resource.Name

for app in reservation_details.Apps:
    print app.Name</code></pre></figure>

<h3 id="accessing-the-sandbox-user-inputs">Accessing the sandbox user inputs</h3>

<p>The user inputs provided by the user when he reserved the blueprint are also a contextual information that can be
accessed by your script. This data is stored in several environment variables based on the input type:</p>

<ul>
  <li>
    <p><strong>Global inputs</strong> - These inputs are a part of the reservation form and can represent general data you wish to
collect from the user for your automation. They can also be used to group together multiple other inputs as one data entry.
You can access these using the <em>GLOBALINPUTS</em> environment variable.</p>
  </li>
  <li>
    <p><strong>Resource requirements</strong> - These are inputs related to abstract resource. An abstract resource in CloudShell allows you to declare a generic spec or requirements for a resource rather than explicitly using a specific one. When customizing such an abstract resource you can choose to make some of its properties available for the user to select, so as to make it more flexible. For example, for a physical device, instead of specifying the model in the blueprint you can set that as a parameter with a dropdown list for the user to select from when reserving it.
Resource requirements are accessed using the <em>RESOURCEREQUIREMENTS</em> environment variable.</p>
  </li>
  <li>
    <p><strong>Resource additional info</strong> -  When customizing an abstract resource you can also choose to add some parameters to the
resource that are not requirements but rather instructions on what to do with it. An example would be specifying an OS
version to install on it. In this case, this parameter is not used to select the resource but rather to operate on the
selected resource in the active environment. Additional info parameters are accessed using the <em>RESOURCEADDITIONALINFO</em>
environment variable.</p>
  </li>
</ul>

<p>As with reservations, we can use some helper modules to get the resource information in Python using the same object we used to get the
 reservation details:</p>

<figure class="highlight"><pre><code class="language-python" data-lang="python">parameters = helpers.get_reservation_context_details().parameters
global_value = parameters.global_inputs[&#39;input name&#39;]
requirement_value = parameters.resource_requirements[&#39;resource1&#39;][&#39;input_name&#39;]
additiona_info_value = parameters.resource_additional_info[&#39;resource1&#39;][&#39;input_name&#39;]</code></pre></figure>

<h3 id="getting-script-input-parameters">Getting script input parameters</h3>

<p>You can add input parameters to a script by editing the it from the Script Management dashboard.
The input parameter values are also provided automatically to your script. CloudShell sets up an environment variable with
the same name as the parameter.</p>

<p>This means that if your script looks like this, with a parameter called ‘Param1’ defined:</p>

<p><img src="/devguide_7/assets/script_param.png" alt="Sandbox information" class="img-responsive" /></p>

<p>You’ll be able to access it using an environment variable by that name:</p>

<figure class="highlight"><pre><code class="language-python" data-lang="python">import os
os.environ[&#39;Param1&#39;]</code></pre></figure>

<p>You can also use the scripting helper class:</p>

<figure class="highlight"><pre><code class="language-python" data-lang="python">import cloudshell.helpers.scripts.cloudshell_scripts_helpers as helpers
helpers.get_user_param(&#39;Param1&#39;)</code></pre></figure>









    <div id="post-nav" class="clearfix">
        
            <a class="prev" href="/devguide_7/orchestration/getting-started.html">&laquo; Getting Started</a>
        
        
            <a class="next" href="/devguide_7/orchestration/script-commands-customization.html">Script commands Visibility and Usability &raquo;</a>
        
    </div>




<div id="disqus_thread"></div>
<script>
    var disqus_config = function () {
        var disqus_identifier = '_orchestration/getting-information-from-cloudshell.md';
        var disqus_url = 'https://qualisystems.github.io/orchestration/getting-information-from-cloudshell.html';
        this.page.url = "https://qualisystems.github.io/devguide_7/orchestration/getting-information-from-cloudshell.html";  // Replace PAGE_URL with your page's canonical URL variable
        this.page.identifier = disqus_identifier; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
    };
    (function() {  // DON'T EDIT BELOW THIS LINE
        var d = document, s = d.createElement('script');

        s.src = '//qualidev.disqus.com/embed.js';

        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript>



<script src="/devguide_7/js/search.min.js" type="text/javascript" charset="utf-8"></script>

<script type="text/javascript">
  $(function() {
    $('#search-query').lunrSearch({
      indexUrl  : '/devguide_7/js/index.json',           // url for the .json file containing search index data
      results   : '#search-results',          // selector for containing search results element
      template  : '#search-results-template', // selector for Mustache.js template
      titleMsg  : '',   // message attached in front of results (can be empty)
      emptyMsg  : '<p>Nothing found.</p>'     // shown message if search returns no results
    });
  });
</script>

<script>
$(function() {
    page = $(".page-header").attr("data-page-id")
    nav_item = $(".nav li[data-page-id='"+page+"']")
    if (nav_item) {
        $(".nav").find(".active").removeClass("active");
        nav_item.addClass("active");
    }
})
</script>

                    </div>
                
            </div>

            

            <div class="row">
                <div id="footer" class="col-sm-12">
                    Documentation for <a href="http://www.quali.com">CloudShell Developer Guide</a>

                </div>
            </div>
        </div>

        <script src="/devguide_7/js/prism.js"></script>

        
        <script>
 (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
 (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
 m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
 })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

 ga('create', 'UA-81468206-1', 'auto');
 ga('send', 'pageview');

</script>

        
    </body>
</html>
